import{capitalizeFirstLetter}from"./helpers.js";const searchInput=document.getElementById("table-search"),tbody=document.querySelector("tbody"),addInstructor=document.getElementById("addInstructor");function setTable(t){tbody.innerHTML="",0==t.data.length&&(tbody.innerHTML='\n        <tr>\n          <td class="px-6 py-4 font-bold" colspan="4"> No Instructor Found </td>\n        </tr>\n    '),"success"===t.status&&t.data.forEach((t=>{const e=document.createElement("tr");e.className="odd:bg-white even:bg-gray-50 bg-white border-b border-gray-200 hover:bg-gray-50";const n=t.is_active?"Active":"Disabled",r=t.is_active?" bg-green-50  text-green-700 ring-green-600/20 ":" bg-red-50 text-red-700 ring-red-600/10 ",s=t.is_active?"Disable":"Enable",o=t.is_active?"text-red-500":"text-green-500",a=t.is_active?'<i class="fa-solid fa-user-slash mr-1"></i>':'<i class="fa-solid fa-user mr-1"></i>';e.innerHTML=`\n                <th scope="row" class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap">\n                    ${capitalizeFirstLetter(t.username)}\n                </th>\n                <td class="px-6 py-4">\n                    ${t.branch_names?capitalizeFirstLetter(t.branch_names):"Not Assigned"}\n                </td>\n                <td class="px-6 py-4">\n                    <span class="inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset  ${r}">\n                        ${n}\n                    </span>\n                </td>\n                <td class="px-6 py-4">\n                    <button class="toggle-status-btn cursor-pointer text-sm border border-gray-300 py-1 px-2 rounded-lg hover:underline ${o}" data-instructor-id="${t.id}">\n                        ${a}\n                        ${s}\n                    </button>\n                </td>\n            `,tbody.appendChild(e)}))}function updateInstructorStatusUI(t,e){const n=e?"Disabled":"Active",r=e?"bg-red-50 text-red-700 ring-red-600/10":"bg-green-50 text-green-700 ring-green-600/20",s=e?"Enable":"Disable",o=e?"text-green-500":"text-red-500",a=e?'<i class="fa-solid fa-user mr-1"></i>':'<i class="fa-solid fa-user-slash mr-1"></i>',c=t.closest("tr").querySelector("td span");c.textContent=n,c.className=`inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset ${r}`,t.innerHTML=`${a} ${s}`,t.className=`toggle-status-btn cursor-pointer text-sm font-medium border border-gray-300 py-1 px-2 rounded-lg ${o} hover:underline`}document.addEventListener("DOMContentLoaded",(function(){searchInput.addEventListener("input",(function(){const t=this.value.trim();fetch(`functions/Instructors/search_instructors.php?search=${encodeURIComponent(t)}`).then((t=>t.json())).then((t=>{setTable(t)})).catch((t=>console.error("Error:",t)))})),tbody.addEventListener("click",(function(t){if(t.target.closest(".toggle-status-btn")){const e=t.target.closest(".toggle-status-btn"),n=e.dataset.instructorId,r="Disable"===e.textContent.trim();confirm(r?"Are you sure you want to disable this instructor?":"Are you sure you want to enable this instructor?")&&fetch("functions/Instructors/toggle_instructor_status.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`instructor_id=${n}`}).then((t=>t.json())).then((t=>{"success"===t.status?(notyf.success("Instructor Updated successfully"),updateInstructorStatusUI(e,r)):alert("Error updating instructor status")})).catch((t=>{console.error("Error:",t),alert("Error updating instructor status")}))}}))})),addInstructor.onclick=function(){fetch("functions/Branches/get_branches.php").then((t=>t.json())).then((t=>{if("success"===t.status){const e=document.getElementById("branchesContainer");e.innerHTML="",t.data.forEach((t=>{const n=document.createElement("label");n.className="flex items-center space-x-2 bg-gray-50 border border-gray-300 rounded-lg px-4 py-2 cursor-pointer hover:bg-gray-100";const r=document.createElement("input");r.type="checkbox",r.name="branch_ids[]",r.value=t.id,r.className="text-blue-600 focus:ring-blue-500 border-gray-300 rounded border";const s=document.createElement("span");s.className="text-gray-900 text-sm",s.textContent=capitalizeFirstLetter(t.name),n.appendChild(r),n.appendChild(s),e.appendChild(n)}))}})).catch((t=>console.error("Error fetching branches:",t)))};