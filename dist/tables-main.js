document.addEventListener("DOMContentLoaded",(async()=>{document.querySelectorAll("button.outline-none").forEach((r=>{r.addEventListener("click",(async r=>{setTimeout((()=>{document.querySelector("#floatClose").classList.remove("hidden")}),300),document.getElementById("drawer-left-example").scrollTop=0;const o=r.currentTarget.dataset.groupId,s=await fetch("functions/Tables/get_group.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({group_id:o,branch_id:t("branch")||1})}),d=await s.json();var i;d.data&&(i=d.data,document.getElementById("edit-btn").href=`groups.php?action=edit&group_id=${i.id}`,document.getElementById("finish-btn").href=`groups.php?action=finish_group&group_id=${i.id}`,document.getElementById("finish-training-btn").dataset.groupId=i.id,document.getElementById("drawerGroup").textContent=n(i.name),document.getElementById("drawerGroup2").textContent=n(i.name),document.getElementById("drawerTrack").textContent=n(i.track_name)||"Not Updated",document.getElementById("langIcon").innerHTML=function(e){if(!e)return"";switch(e.toLowerCase()){case"html":return'<i class="fa-brands fa-html5 text-5xl text-slate-700"></i>';case"css":return'<i class="fa-brands fa-css text-5xl text-slate-700"></i>';case"javascript":return'<i class="fa-brands fa-js text-5xl text-slate-700"></i>';case"php":return'<img class="w-[55px]" src="images/php.png" >';case"database":return'<img class="w-20" src="images/database.png" >';case"project":return'<img class="w-[55px]" src="images/project.svg" >';default:return""}}(i.track_name),document.getElementById("drawerTime").textContent=e(i.time),document.getElementById("drawerDay").textContent=n(i.day),document.getElementById("drawerInstructor").textContent=n(i.instructor_name),document.getElementById("drawerBranch").textContent=n(i.branch_name),document.getElementById("drawerBranch2").textContent=n(i.branch_name),document.getElementById("drawerStartMonth").innerHTML=n(i.month),document.getElementById("drawerStartDate").innerHTML=i.start_date,document.getElementById("drawerEndMonth").innerHTML=n(i.group_end_month),document.getElementById("drawerEndDate").innerHTML=i.group_end_date,document.getElementById("today").innerHTML=function(e=new Date){const t=["January","February","March","April","May","June","July","August","September","October","November","December"],n=String(e.getDate()).padStart(2,"0"),a=String(e.getMonth()+1).padStart(2,"0"),r=e.getFullYear();return`\n    <p class="text-xs font-medium text-gray-400 uppercase tracking-wider">NOW</p>\n    <p class="month">${t[e.getMonth()]}</p>\n    <p class="date">${n}-${a}-${r}</p>\n  `}(),document.getElementById("time-left").innerHTML=a(i.start_date,i.name),document.getElementById("time-left2").innerHTML=a(i.start_date,i.name),d.data.name.toLowerCase().includes("training")?(document.getElementById("finish-btn").classList.add("hidden"),document.getElementById("finish-training-btn").classList.remove("hidden")):(document.getElementById("finish-btn").classList.remove("hidden"),document.getElementById("finish-training-btn").classList.add("hidden")),document.getElementById("finish-training-btn").addEventListener("click",(async e=>{e.preventDefault();const t=e.target.dataset.groupId;if(confirm("Are you sure you want to mark this Training group as finished?"))try{const e=await fetch("functions/Groups/finish_training_group.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`id=${encodeURIComponent(t)}`});"success"===(await e.json()).status&&(await fetch("functions/Tables/flash_session.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"session_name=Training Group Finished Successfully"}),window.location.reload())}catch(e){alert("Request failed."),console.error(e)}})))}))}));const e=e=>{const t=+e;return 2===t||5===t?`${e} - Friday`:6.1===t||8===t?`Online ${Math.floor(e)}`:`${e}`};function t(e){return new URLSearchParams(window.location.search).get(e)}function n(e){return"string"!=typeof e||0===e.length?e:e.charAt(0).toUpperCase()+e.slice(1)}function a(e,t){const[n,a,r]=e.split("-").map(Number),o=new Date(r,a-1,n),s=t.toLowerCase().includes("training"),d=s?2:5,i=s?15:14,c=new Date(o);c.setMonth(c.getMonth()+d),c.setDate(c.getDate()+i);const m=new Date;if(m.setHours(0,0,0,0),c<m)return'<p class="time-remaining">Completed</p>';let l=c.getMonth()-m.getMonth();l+=12*(c.getFullYear()-m.getFullYear());const u=new Date(m);u.setMonth(u.getMonth()+l);let g=Math.floor((c-u)/864e5);return g<0&&(l--,u.setMonth(u.getMonth()-1),g=Math.floor((c-u)/864e5)),`\n    <p class="text-xs font-medium text-gray-400 uppercase tracking-wider">Time Left</p>\n    <p class="time-remaining">${l} months</p>\n    <p class="time-remaining">${g} days</p>\n  `}}));