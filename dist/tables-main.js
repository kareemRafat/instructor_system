const groupBtn=document.querySelectorAll("button.outline-none");document.addEventListener("DOMContentLoaded",(async()=>{groupBtn.forEach((r=>{r.addEventListener("click",(async r=>{const o=r.currentTarget.dataset.groupId,d=await fetch("functions/Tables/get_group.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({group_id:o,branch_id:t("branch")||1})}),s=await d.json();var i;s.data&&(i=s.data,document.getElementById("edit-btn").href=`groups.php?action=edit&group_id=${i.id}`,document.getElementById("finish-btn").href=`groups.php?action=finish_group&group_id=${i.id}`,document.getElementById("finish-training-btn").dataset.groupId=i.id,document.getElementById("drawerGroup").textContent=n(i.name),document.getElementById("drawerGroup2").textContent=n(i.name),document.getElementById("drawerTrack").textContent=n(i.track_name)||"Not Updated",document.getElementById("langIcon").innerHTML=function(e){if(!e)return"";switch(e.toLowerCase()){case"html":return'<i class="fa-brands fa-html5 text-5xl text-slate-700"></i>';case"css":return'<i class="fa-brands fa-css text-5xl text-slate-700"></i>';case"javascript":return'<i class="fa-brands fa-js text-5xl text-slate-700"></i>';case"php":return'<img class="w-[55px]" src="images/php.png" >';case"database":return'<img class="w-20" src="https://www.mysql.com/common/logos/logo-mysql-170x115.png" >';case"project":break;default:return""}}(i.track_name),document.getElementById("drawerTime").textContent=e(i.time),document.getElementById("drawerDay").textContent=n(i.day),document.getElementById("drawerInstructor").textContent=n(i.instructor_name),document.getElementById("drawerBranch").textContent=n(i.branch_name),document.getElementById("drawerStartMonth").innerHTML=n(i.month),document.getElementById("drawerStartDate").innerHTML=i.start_date,document.getElementById("drawerEndMonth").innerHTML=n(i.group_end_month),document.getElementById("drawerEndDate").innerHTML=i.group_end_date,document.getElementById("today").innerHTML=function(e=new Date){const t=["January","February","March","April","May","June","July","August","September","October","November","December"],n=String(e.getDate()).padStart(2,"0"),a=String(e.getMonth()+1).padStart(2,"0"),r=e.getFullYear();return`\n    <p class="text-xs font-medium text-gray-400 uppercase tracking-wider">NOW</p>\n    <p class="month">${t[e.getMonth()]}</p>\n    <p class="date">${n}-${a}-${r}</p>\n  `}(),document.getElementById("time-left").innerHTML=a(i.start_date),document.getElementById("time-left2").innerHTML=a(i.start_date),s.data.name.toLowerCase().includes("training")?(document.getElementById("finish-btn").classList.add("hidden"),document.getElementById("finish-training-btn").classList.remove("hidden")):(document.getElementById("finish-btn").classList.remove("hidden"),document.getElementById("finish-training-btn").classList.add("hidden")),document.getElementById("finish-training-btn").addEventListener("click",(async e=>{e.preventDefault();const t=e.target.dataset.groupId;if(confirm("Are you sure you want to mark this Training group as finished?"))try{const e=await fetch("functions/Groups/finish_training_group.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`id=${encodeURIComponent(t)}`});"success"===(await e.json()).status&&(await fetch("functions/Tables/flash_session.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"session_name=Training Group Finished Successfully"}),window.location.reload())}catch(e){alert("Request failed."),console.error(e)}})))}))}));const e=e=>{const t=+e;return 2===t||5===t?`${e} - Friday`:6.1===t||8===t?`Online ${Math.floor(e)}`:`${e}`};function t(e){return new URLSearchParams(window.location.search).get(e)}function n(e){return"string"!=typeof e||0===e.length?e:e.charAt(0).toUpperCase()+e.slice(1)}function a(e){const[t,n,a]=e.split("-").map(Number),r=new Date(a,n-1,t),o=new Date(r);o.setMonth(o.getMonth()+5),o.setDate(o.getDate()+15);const d=o-new Date;if(d<=0)return'\n      <p class="time-remaining">Completed</p>\n    ';const s=Math.floor(d/864e5);return`\n    <p class="text-xs font-medium text-gray-400 uppercase tracking-wider">Time Left</p>\n    <p>${Math.floor(s/30)} Months </p>\n    <p>${s%30} Days</p>\n  `}}));