const agentId=document.getElementById("agent-id").dataset.agentId,createdAt=document.getElementById("created-at").dataset.createdAt,salaryPreload=document.getElementById("salary-preload"),drawerList=document.getElementById("reason-list"),actionBTN=document.getElementById("actionBTN"),bonuses=document.querySelector('[data-action="bonuses"]'),deductions=document.querySelector('[data-action="deduction_days"]'),advances=document.querySelector('[data-action="advances"]'),absentDays=document.querySelector('[data-action="absent_days"]'),overtime=document.querySelector('[data-action="overtime"]');function bonusCard(e){return`<div class="relative pl-10 group">\n    \x3c!-- Animated Dot with pulse effect --\x3e\n    <div class="absolute left-0 top-4 w-3 h-3 bg-green-500 rounded-full ring-4 ring-green-100 group-hover:scale-125 transition-all duration-300 animate-pulse"></div>\n\n    <div class="bg-white border border-gray-200 px-5 py-3 shadow-sm hover:shadow-md transition-all duration-300 hover:border-green-300 hover:-translate-y-0.5">\n        <div class="flex items-center justify-between mb-2">\n            <span class="text-xs font-semibold text-green-700 bg-green-100 px-3 py-1 rounded-full inline-flex items-center">\n                <svg class="w-3 h-3 ml-2" fill="currentColor" viewBox="0 0 20 20">\n                    <path fill-rule="evenodd" d="M12 7a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0V8.414l-4.293 4.293a1 1 0 01-1.414 0L8 10.414l-4.293 4.293a1 1 0 01-1.414-1.414l5-5a1 1 0 011.414 0L11 10.586 14.586 7H12z" clip-rule="evenodd" />\n                </svg>\n                المكافآت\n            </span>\n            <span class="text-base font-semibold text-slate-600">${e.amount} جنيه</span>\n        </div>\n        \n        <h3 class="text-gray-900 font-semibold text-base mb-2 line-clamp-2">\n            ${e.reason}\n        </h3>\n        \n        <hr class="border-gray-100 my-3">\n        \n        <div class="flex items-center justify-between text-sm text-gray-500 mt-2">\n            <span class="flex items-center gap-1 text-gray-800 font-semibold text-sm">\n                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">\n                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />\n                </svg>\n                ${e.bonus_created_at.slice(0,10)}\n            </span>\n        </div>\n    </div>\n</div>`}function deductionCard(e){return`<div class="relative pl-10 group">\n                \x3c!-- Animated Dot with pulse effect --\x3e\n                <div class="absolute left-0 top-4 w-3 h-3 bg-red-500 rounded-full ring-4 ring-red-100 group-hover:scale-125 transition-all duration-300 animate-pulse"></div>\n\n                <div class="bg-white border border-gray-200 px-5 py-3 shadow-sm hover:shadow-md transition-all duration-300 hover:border-red-300 hover:-translate-y-0.5">\n                    <div class="flex items-center justify-between mb-2">\n                        <span class="text-xs font-medium text-red-600 bg-red-50 px-2 py-0.5 rounded-full inline-flex items-center">\n                            <svg class="w-3 h-3 ml-2" fill="currentColor" viewBox="0 0 20 20">\n                                <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path>\n                            </svg>\n                            الخصومات\n                        </span>\n                        <span class="text-base font-semibold text-slate-600">${e.days} يوم</span>\n                    </div>\n                    \n                    <h3 class="text-gray-900 font-semibold text-base mb-2 line-clamp-2">\n                        ${e.reason}\n                    </h3>\n                    \n                    <hr class="border-gray-100 my-3">\n                    \n                    <div class="flex items-center justify-between text-sm text-gray-500 mt-2">\n                        <span class="flex items-center gap-1 text-gray-800 font-semibold text-sm">\n                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">\n                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />\n                            </svg>\n                            ${e.deductions_created_at.slice(0,10)}\n                        </span>\n                    </div>\n                </div>\n            </div>`}function advancesCard(e){return`<div class="relative pl-10 group">\n                \x3c!-- Animated Dot with pulse effect --\x3e\n                <div class="absolute left-0 top-4 w-3 h-3 bg-orange-500 rounded-full ring-4 ring-orange-100 group-hover:scale-125 transition-all duration-300 animate-pulse"></div>\n                <div class="bg-white border border-gray-200 px-5 py-3 shadow-sm hover:shadow-md transition-all duration-300 hover:border-orange-300 hover:-translate-y-0.5">\n                    <div class="flex items-center justify-between mb-2">\n                        <span class="text-xs font-medium text-orange-600 bg-red-50  px-2 py-0.5 rounded-full inline-flex items-center">\n                            <svg class="w-3 h-3 ml-2" fill="currentColor" viewBox="0 0 20 20">\n                                <path d="M4 4a2 2 0 00-2 2v4a2 2 0 002 2V6h10a2 2 0 00-2-2H4zm2 6a2 2 0 012-2h8a2 2 0 012 2v4a2 2 0 01-2 2H8a2 2 0 01-2-2v-4zm6 4a2 2 0 100-4 2 2 0 000 4z"></path>\n                            </svg>\n                             السلف\n                        </span>\n                        <span class="text-base font-semibold text-slate-600">${e.amount} جنيه</span>\n                    </div>\n                    \n                    <h3 class="text-gray-900 font-semibold text-base mb-2 line-clamp-2">\n                        ${e.reason}\n                    </h3>\n                    \n                    <hr class="border-gray-100 my-3">\n                    \n                    <div class="flex items-center justify-between text-sm text-gray-500 mt-2">\n                        <span class="flex items-center gap-1 text-gray-800 font-semibold text-sm">\n                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">\n                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />\n                            </svg>\n                            ${e.advances_created_at.slice(0,10)}\n                        </span>\n                    </div>\n                </div>\n            </div>`}function absentCard(e){return`<div class="relative pl-10 group">\n                \x3c!-- Animated Dot with pulse effect --\x3e\n                <div class="absolute left-0 top-4 w-3 h-3 bg-red-500 rounded-full ring-4 ring-red-100 group-hover:scale-125 transition-all duration-300 animate-pulse"></div>\n\n                <div class="bg-white border border-gray-200 px-5 py-3 shadow-sm hover:shadow-md transition-all duration-300 hover:border-red-300 hover:-translate-y-0.5">\n                    <div class="flex items-center justify-between mb-2">\n                        <span class="text-xs font-medium text-red-600 bg-red-50 p-2  py-0.5 rounded-full inline-flex items-center">\n                            <svg class="w-3 h-3 ml-2" fill="currentColor" viewBox="0 0 20 20">\n                                <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path>\n                            </svg>\n                            الـغـيـاب\n                        </span>\n                        <span class="text-base font-semibold text-slate-600">${e.days} يوم</span>\n                    </div>\n                    \n                    <h3 class="text-gray-900 font-semibold text-base mb-2 line-clamp-2">\n                        ${e.reason}\n                    </h3>\n                    \n                    <hr class="border-gray-100 my-3">\n                    \n                    <div class="flex items-center justify-between text-sm text-gray-500 mt-2">\n                        <span class="flex items-center gap-1 text-gray-800 font-semibold text-sm">\n                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">\n                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />\n                            </svg>\n                            يوم الغياب : \n                            ${e.absent_created_at.slice(0,10)}\n                        </span>\n                    </div>\n                </div>\n            </div>`}function overtimeCard(e){return`<div class="relative pl-10 group">\n                \x3c!-- Animated Dot with pulse effect --\x3e\n                <div class="absolute left-0 top-4 w-3 h-3 bg-blue-500 rounded-full ring-4 ring-blue-100 group-hover:scale-125 transition-all duration-300 animate-pulse"></div>\n\n                <div class="bg-white border border-gray-200 px-5 py-3 shadow-sm hover:shadow-md transition-all duration-300 hover:border-blue-300 hover:-translate-y-0.5">\n                    <div class="flex items-center justify-between mb-2">\n                        <span class="text-xs font-medium text-blue-600 bg-blue-50 p-2  py-0.5 rounded-full inline-flex items-center">\n                            <svg class="w-3 h-3 ml-2" fill="currentColor" viewBox="0 0 20 20">\n                                <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path>\n                            </svg>\n                            أوفر تايم + مكافأت\n                        </span>\n                        <span class="text-base font-semibold text-slate-600">${e.days} يوم</span>\n                    </div>\n                    \n                    <h3 class="text-gray-900 font-semibold text-base mb-2 line-clamp-2">\n                        ${e.reason}\n                    </h3>\n                    \n                    <hr class="border-gray-100 my-3">\n                    \n                    <div class="flex items-center justify-between text-sm text-gray-500 mt-2">\n                        <span class="flex items-center gap-1 text-gray-800 font-semibold text-sm">\n                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">\n                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />\n                            </svg>\n                            ${e.overtime_created_at.slice(0,10)}\n                        </span>\n                    </div>\n                </div>\n            </div>`}function capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}bonuses.addEventListener("click",async function(){const e=this.dataset.action;actionBTN.innerText=capitalizeFirstLetter(e),salaryPreload.classList.remove("hidden"),drawerList.innerHTML="";try{const e=await fetch("functions/Salary/fetch/get_bonuses.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`agent_id=${encodeURIComponent(agentId)}&created_at=${encodeURIComponent(createdAt)}`}),t=await e.json();"success"===t.status&&(salaryPreload.classList.add("hidden"),t.bonuses.forEach(e=>{drawerList.innerHTML+=bonusCard(e)}))}catch(e){alert("Request failed."),console.error(e)}}),deductions.addEventListener("click",async function(){const e=this.dataset.action;actionBTN.innerText=capitalizeFirstLetter(e),salaryPreload.classList.remove("hidden"),drawerList.innerHTML="";try{const e=await fetch("functions/Salary/fetch/get_deduction_days.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`agent_id=${encodeURIComponent(agentId)}&created_at=${encodeURIComponent(createdAt)}`}),t=await e.json();"success"===t.status&&(salaryPreload.classList.add("hidden"),t.deductionDays.forEach(e=>{drawerList.innerHTML+=deductionCard(e)}))}catch(e){alert("Request failed."),console.error(e)}}),advances.addEventListener("click",async function(){const e=this.dataset.action;actionBTN.innerText=capitalizeFirstLetter(e),salaryPreload.classList.remove("hidden"),drawerList.innerHTML="";try{const e=await fetch("functions/Salary/fetch/get_advances.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`agent_id=${encodeURIComponent(agentId)}&created_at=${encodeURIComponent(createdAt)}`}),t=await e.json();"success"===t.status&&(salaryPreload.classList.add("hidden"),t.advances.forEach(e=>{drawerList.innerHTML+=advancesCard(e)}))}catch(e){alert("Request failed."),console.error(e)}}),absentDays.addEventListener("click",async function(){const e=this.dataset.action;actionBTN.innerText=capitalizeFirstLetter(e),salaryPreload.classList.remove("hidden"),drawerList.innerHTML="";try{const e=await fetch("functions/Salary/fetch/get_absent_days.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`agent_id=${encodeURIComponent(agentId)}&created_at=${encodeURIComponent(createdAt)}`}),t=await e.json();"success"===t.status&&(salaryPreload.classList.add("hidden"),t.absentDays.forEach(e=>{drawerList.innerHTML+=absentCard(e)}))}catch(e){alert("Request failed."),console.error(e)}}),overtime.addEventListener("click",async function(){const e=this.dataset.action;actionBTN.innerText=capitalizeFirstLetter(e),salaryPreload.classList.remove("hidden"),drawerList.innerHTML="";try{const e=await fetch("functions/Salary/fetch/get_overtime.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`agent_id=${encodeURIComponent(agentId)}&created_at=${encodeURIComponent(createdAt)}`}),t=await e.json();"success"===t.status&&(salaryPreload.classList.add("hidden"),t.overtime.forEach(e=>{drawerList.innerHTML+=overtimeCard(e)}))}catch(e){alert("Request failed."),console.error(e)}});