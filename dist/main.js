import{capitalizeFirstLetter}from"./helpers.js";const groupSelect=document.getElementById("group"),track=document.getElementById("track"),list=document.getElementById("lecture-list"),startDate=document.getElementById("start-date"),endDate=document.getElementById("end-date");async function getGroupTrack(t){const e=await fetch(`functions/Lectures/get_group_track.php?group_id=${t}`),n=await e.json();if(n.data){document.querySelector(`#track option[value="${n.data.track_id}"]`).selected=!0,track.dispatchEvent(new Event("input",{bubbles:!0}))}}async function getGroupInfo(t){const e=await fetch(`functions/Groups/get_group.php?group_id=${t}`),n=await e.json();n.data&&(startDate.innerText=n.data.formatted_date,endDate.innerText="End : "+n.data.group_end_date)}function resetListScroll(){list.style.display="block",list.scrollTop=0,list.style.display="none"}document.addEventListener("DOMContentLoaded",(()=>{fetch("functions/Groups/get_groups.php").then((t=>t.json())).then((t=>{t.data&&t.data.forEach((t=>{const e=document.createElement("option");e.value=t.id,e.textContent=capitalizeFirstLetter(t.name),t.name.toLowerCase().includes("training")||groupSelect.append(e)}))})).catch((t=>console.error("Error fetching groups:",t))),fetch("functions/Tracks/get_tracks.php").then((t=>t.json())).then((t=>{track.innerHTML='<option value="">Select Track</option>',t.data&&t.data.forEach((t=>{const e=document.createElement("option");e.value=t.id,e.textContent=t.name.toUpperCase(),track.appendChild(e)}))})).catch((t=>console.error("Error fetching groups:",t)))})),groupSelect.oninput=async function(){const t=this.value;if(!t)return track.value="",list.innerHTML='<li class="text-left px-3 py-1 text-gray-500 font-semibold cursor-default">Select Track First</li>',startDate.innerText="Group Start Date",void(endDate.innerText="Excpected End Date");try{await getGroupTrack(t),await getGroupInfo(t)}catch(t){console.error("Error fetching tracks:",t)}resetListScroll()};